## FTP Check (TCP 21) <br>
#### FTP Anonymous Login<br>
#### Tools <br>
nmap -sSV --script ftp-anon.nse -p21 IP -T4 --reason <br>

#### Solution <br>
1. Disable FTP and use SSH <br>
2. Disable FTP Anonymous Login <br>
https://antnix07.blogspot.com/2018/01/disable-anonymous-user-in-ftp-server-on.html <br>
<hr>

## DNS Check (TCP 53) <br>
#### DNS Server Cache Snooping Remote Information Disclosure<br>
#### Tools <br>
nmap -sU -p 53 --script dns-cache-snoop <ip_address> <br>

#### Solution <br>
1. Leave recursion enabled if the DNS Server resides on a corporate network that cannot be reached by untrusted clients <br>
2. Do not allow public access to DNS Servers performing recursion <br>
3. Disable recursion <br>
https://support.microsoft.com/en-us/help/2678371/microsoft-dns-server-vulnerability-to-dns-server-cache-snooping-attack
<hr>

#### DNS Server Spoofed Request Amplification DDoS<br>
#### Tools <br>
msf > use auxiliary/scanner/dns/dns_amp <br>

#### Solution <br>
1. Restrict access to your DNS server from public network or reconfigure it to reject such queries
<hr>

#### DNS Server Recursive Query Cache Poisoning Weakness<br>
#### Tools <br>
nmap -Pn -sU -p 53 --script=dns-recursion <ip_address> <br>

#### Solution <br>
1. Restrict recursive queries to the hosts that should use this nameserver (such as those of the LAN connected to it) <br>
2. If bind 8 is in use, use the instruction 'allow-recursion' in the 'options' section of the named.conf <br>
3. If bind 9 is in use, define a grouping of internal addresses using the 'acl' command <br>
Then, within the options block, you can explicitly state:  <br>
'allow-recursion { hosts_defined_in_acl }' <br>
If another name server is in use, consult its documentation. <br>
<hr>

#### DNS Server Zone Transfer Information Disclosure (AXFR)<br>
#### Tools <br>
dig axfr @<ip_address> <domain.name> <br>

#### Solution <br>
N/A<br>
<hr>

#### Remove IIS Server version HTTP Response Header (TCP 80) <br>
nmap -sV -T5 -Pn -p 80 --script http-headers IPs
##### Solution <br>
https://www.saotn.org/remove-iis-server-version-http-response-header/<br>
https://blogs.msdn.microsoft.com/varunm/2013/04/23/remove-unwanted-http-response-headers/ <br>

#### Header Check <br>
#### Tools <br>
https://github.com/koenbuyens/securityheaders <br>
#### Solution <br>
http://securityheaders.io/ <br>
#### Link <br>
##### Content Security Policy Explaination <br>
https://csp.withgoogle.com/docs/index.html <br>
#### Etag Headers <br>
What benefit using etag? <br>
The ETag HTTP response header is an identifier for a specific version of a resource. It lets caches be more efficient and save bandwidth, as a web server does not need to resend a full response if the content has not changed. Additionally, etags help prevent simultaneous updates of a resource from overwriting each other <br>
#### link <br>
https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/ETag <br>
#### misconfiguration of etag <br>
Sometimes ETag header providing sensitive information that could aid an attacker, such as the inode number <br>
#### link <br>
https://www.tenable.com/plugins/nessus/88098<br>
https://www.securityfocus.com/bid/6939/discuss<br>
#### What the use of inode number? <br>
https://tecadmin.net/what-is-inode-number-in-linux/ <br>
#### Solution <br>
IIS : https://www.saotn.org/remove-etags-http-header-iis/ <br>

<hr>
## SNMP (TCP/UDP 161) <br>
#### SNMP Enum<br>
#### Tools <br>
nmap -sV -p161 --script snmp-info IP --reason -T4 <br>
nmap -sU -p161 --script snmp-info IP --reason -T4 <br>
snmpwalk -c public/private/any -v1/2c IP <br>

#### Solution <br>
N/A <br>
<hr>

## SSL Check (TCP 443) <br> 
1. Check for cipher strength 
nmap -sSCV -Pn --script ssl-enum-ciphers -p443 IP<br>
sslscan IP <br>
#### Tools<br> 
https://github.com/rbsec/sslscan<br>
https://github.com/nabla-c0d3/sslyze<br>
https://testssl.sh/<br>
#### Solution<br>
Windows: https://www.nartac.com/Products/IISCrypto/ <br>
<hr>

## SMBv1 Check (TCP 445) <br>
#### Smb protocols <br>
nmap -sV -T5 -Pn -p 445 --script smb-protocols IPs<br>
#### Solution <br>
https://support.microsoft.com/en-us/help/2696547/detect-enable-disable-smbv1-smbv2-smbv3-in-windows-and-windows-server<br>

#### Smb Singing <br>
nmap -sV -T5 -Pn -p 445 --script smb-security-mode IPs <br>
#### Solution <br>
https://support.microsoft.com/en-my/help/161372/how-to-enable-smb-signing-in-windows-nt <br>
<hr>


## RDP Check (TCP 3389) <br>
#### NLA,FIPS,ENC <br>
Network Level Authentication (NLA) Disabled<br>
Terminal Services Encryption Level is Medium or Low, or<br>
Terminal Services Encryption Level is not FIPS-140 Compliant<br>
#### Tools <br>
https://github.com/portcullislabs/rdp-sec-check<br>
#### Solution <br>
videos:https://www.youtube.com/watch?v=nyBOJwvUaKQ<br>
Link:https://www.phr33fall.co.uk/windows-rdp-hardening/<br>
<hr>
